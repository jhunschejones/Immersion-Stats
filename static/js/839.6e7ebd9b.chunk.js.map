{"version":3,"file":"static/js/839.6e7ebd9b.chunk.js","mappings":"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","sources":["components/StudyTrendsPage.js","utils/urls.js"],"sourcesContent":["import { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Tooltip, Legend } from \"chart.js\";\nimport annotationPlugin from \"chartjs-plugin-annotation\";\nimport { Line } from \"react-chartjs-2\";\nimport { useContext, useMemo, useState } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { getSearchParams } from \"../utils/urls\";\nimport { parseCsvFile } from \"../utils/parsing\";\nimport { JpdbContext } from \"../providers/JpdbProvider\";\nimport { BunproContenxt } from \"../providers/BunproProvider\";\nimport { AnkiContext } from \"../providers/AnkiProvider\";\nimport { ImmersionContext } from \"../providers/ImmersionProvider\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\n\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Tooltip, Legend, annotationPlugin);\n\n\n/**\n * Build an array of all dates between two dates\n *\n * @param {Date} startDate - the start of the date range\n * @param {Date} endDate - the end of the date range\n * @returns {array<Date>}\n */\nexport const getDatesBetween = (startDate, endDate) => {\n  const currentDate = new Date(startDate.getTime());\n  const dates = [];\n  while (currentDate <= endDate) {\n    dates.push(new Date(currentDate));\n    currentDate.setDate(currentDate.getDate() + 1);\n  }\n  return dates;\n};\n\nconst DATE_RANGES = [\"10D\", \"1M\", \"3M\", \"1Y\"];\n\nconst tenDaysAgo = new Date(new Date().setDate(new Date().getDate() - 10));\nconst oneMonthAgo = new Date(new Date().setMonth(new Date().getMonth() - 1));\nconst threeMonthsAgo = new Date(new Date().setMonth(new Date().getMonth() - 3));\nconst oneYearAgo = new Date(new Date().setFullYear(new Date().getFullYear() - 1));\n\nconst tenDaysAgoDateRange = getDatesBetween(tenDaysAgo, new Date());\nconst oneMonthDateRange = getDatesBetween(oneMonthAgo, new Date());\nconst threeMonthsDateRange = getDatesBetween(threeMonthsAgo, new Date());\nconst oneYearDateRange = getDatesBetween(oneYearAgo, new Date());\n\nconst datesForDateRangeString = (dateRange) => {\n  if (dateRange == \"1M\") {\n    return oneMonthDateRange;\n  }\n  if (dateRange == \"3M\") {\n    return threeMonthsDateRange;\n  }\n  if (dateRange == \"1Y\") {\n    return oneYearDateRange;\n  }\n  // default date range is 10D\n  return tenDaysAgoDateRange;\n};\n\nconst chartLablesByDateRange = {};\nDATE_RANGES.forEach((dateRange) => {\n  chartLablesByDateRange[dateRange] = datesForDateRangeString(dateRange).map(d => d.toLocaleDateString(\"en-US\", { month: \"numeric\", day: \"numeric\", weekday: \"short\" }));\n});\n\n\n/**\n * A helper method to transform a `dataset` or several datasets into an array of chart data for a given `dateRange`,\n * filling in `0`s for missing days.\n *\n * @param {{} | []} dataset - a single dataset or an array of datasets\n * @param {string | array<Date>} dateRange\n * @returns {array<{ \"Date\": string, \"Time (mins)\": string }>}\n */\nexport const datasetToPaddedArray = (dataset, dateRange) => {\n  const datasetArray = Array(dataset).flat(); // support a single dataset or an array of datasets\n  const range = (typeof dateRange == \"string\") ? datesForDateRangeString(dateRange) : dateRange;\n\n  return range.map((date) => {\n    const dateKey = date.toISOString().split(\"T\")[0];\n    const matchingDataEntries = datasetArray.map((d) => d[dateKey]).filter((d) => d != undefined);\n    if (matchingDataEntries.length > 0) {\n      return { date: date, minutesStudied: matchingDataEntries.map((d) => d.minutesStudied).reduce((a, b) => a + b, 0) };\n    }\n    return { date: date, minutesStudied: 0 };\n  });\n};\n\n/**\n * Parses a CSV with at least `Date` and `Time (mins)` columns into a standardized dataset object, summing\n * `Time (mins)` for duplicate entries.\n *\n * @param {array<{ \"Date\": string, \"Time (mins)\": string }>} csvData\n * @returns {{string: {date: Date, minutesStudied: number}}} - data set keyed by date string\n */\nexport const standardizedCsvToDataset = (csvData) => {\n  const result = {};\n  parseCsvFile(csvData).forEach((d) => {\n    const date = new Date(d[\"Date\"]);\n    const dateStringKey = date.toISOString().split(\"T\")[0];\n    if (result[dateStringKey]) {\n      const previousMinutesStudied = result[dateStringKey].minutesStudied;\n      result[dateStringKey] = { date: date, minutesStudied: parseFloat(d[\"Time (mins)\"]) + previousMinutesStudied };\n    } else {\n      result[dateStringKey] = { date: date, minutesStudied: parseFloat(d[\"Time (mins)\"]) };\n    }\n  });\n  return result;\n};\n\n// charts.js helper method to parse the chart `ctx` object and return an average value for the given dataset `index`\nconst avgFromChartCtx = (chartCtx, index) => {\n  if (!chartCtx) return undefined;\n  try {\n    const values = chartCtx.chart.data.datasets.at(index).data;\n    return values.reduce((a, b) => a + b, 0) / values.length;\n  } catch (error) {\n    return undefined;\n  }\n};\n\nconst defaultChartOptions = {\n  responsive: true,\n  maintainAspectRatio: false,\n  plugins: {\n    legend: {\n      position: \"top\",\n    },\n    annotation: {\n      animation: false,\n      annotations: {\n        averageTotal: {\n          display: false\n        }\n      }\n    }\n  },\n  scales: {\n    y: {\n      title: {\n        display: true,\n        text: \"Study minutes\"\n      }\n    }\n  }\n};\n\nconst chartOptionsWithAverageAnnotation = (index) => {\n  return {\n    ...defaultChartOptions,\n    plugins: {\n      ...defaultChartOptions.plugins,\n      annotation: {\n        ...defaultChartOptions.plugins.annotation,\n        annotations: {\n          ...defaultChartOptions.plugins.annotation.annotations,\n          averageTotal: {\n            type: \"line\",\n            scaleID: \"y\",\n            value: (ctx) => avgFromChartCtx(ctx, index) ?? 0,\n            display: (ctx) => !ctx.chart.legend.legendItems.at(index).hidden,\n            label: {\n              display: true,\n              content: (ctx) => `Avg: ${avgFromChartCtx(ctx, index)?.toFixed(0)} mins/day`,\n              backgroundColor: (ctx) => ctx.chart.data.datasets.at(index).borderColor,\n              color: (ctx) => {\n                // show gray text for gray background\n                if (ctx.chart.data.datasets.at(index).borderColor == \"#e5e5e5\") {\n                  return \"#777\";\n                }\n                // show white text for all other backgrounds\n                return \"#FFF\";\n              },\n              backgroundShadowColor: \"#b7b7b7\",\n              shadowOffsetX: 3,\n              shadowOffsetY: 3,\n              shadowBlur: 4,\n            },\n            borderColor: (ctx) => ctx.chart.data.datasets.at(index).borderColor,\n            borderDash: [6, 6],\n            borderWidth: 3,\n            drawTime: \"afterDraw\",\n            shadowOffsetX: 3,\n            shadowOffsetY: 3,\n            shadowBlur: 4,\n            borderShadowColor: \"#b7b7b7\",\n          }\n        }\n      }\n    }\n  };\n};\n\n\nexport default function StudyTrendsPage () {\n  const {jpdbData, jpdbIsLoading} = useContext(JpdbContext);\n  const {bunproData, bunproIsLoading} = useContext(BunproContenxt);\n  const {ankiData, ankiDataIsLoading} = useContext(AnkiContext);\n  const {immersionData, immersionIsLoading} = useContext(ImmersionContext);\n\n  const [searchParams, setSearchParams] = useSearchParams();\n  const selectedDateRange = useMemo(() => {\n    const urlDateRange = getSearchParams().get(\"dateRange\")?.trim();\n    if (urlDateRange && DATE_RANGES.includes(urlDateRange)) return urlDateRange;\n    return DATE_RANGES[0];\n  }, [searchParams]);\n\n  const [datasetIndexToShowAverageFor, setDatasetIndexToShowAverageFor] = useState(undefined);\n  const chartOptions = useMemo(() => {\n    if (datasetIndexToShowAverageFor == undefined) return defaultChartOptions;\n    return chartOptionsWithAverageAnnotation(datasetIndexToShowAverageFor);\n  }, [datasetIndexToShowAverageFor]);\n\n  // press `1` to show the average for the dataset at index `0`, the `jpdb.io` dataset\n  useHotkeys(\"1\", () => setDatasetIndexToShowAverageFor(s => s == 0 ? undefined : 0), []);\n  // press `1` to show the average for the dataset at index `1`, the `Bunpro` dataset\n  useHotkeys(\"2\", () => setDatasetIndexToShowAverageFor(s => s == 1 ? undefined : 1), []);\n  // press `1` to show the average for the dataset at index `2`, the `Anki` dataset\n  useHotkeys(\"3\", () => setDatasetIndexToShowAverageFor(s => s == 2 ? undefined : 2), []);\n  // press `1` to show the average for the dataset at index `3`, the `Immersion` dataset\n  useHotkeys(\"4\", () => setDatasetIndexToShowAverageFor(s => s == 3 ? undefined : 3), []);\n  // press `5` to show the average for the dataset at index `4`, the `totals` dataset\n  useHotkeys(\"5\", () => setDatasetIndexToShowAverageFor(s => s == 4 ? undefined : 4), []);\n  // press `backspace` to remove any average lines being shown\n  useHotkeys(\"backspace\", () => setDatasetIndexToShowAverageFor(undefined), []);\n\n  const dataSetsBySource = useMemo(() => {\n    if (jpdbIsLoading || bunproIsLoading || ankiDataIsLoading || immersionIsLoading) return {};\n    if ([jpdbData, bunproData, ankiData, immersionData].includes(undefined)) return {};\n    return {\n      jpdb: standardizedCsvToDataset(jpdbData),\n      bunpro: standardizedCsvToDataset(bunproData),\n      anki: standardizedCsvToDataset(ankiData),\n      immersion: standardizedCsvToDataset(immersionData)\n    };\n  }, [jpdbIsLoading, jpdbData, bunproIsLoading, bunproData, ankiDataIsLoading, ankiData, immersionIsLoading, immersionData]);\n\n  const chartData = useMemo(() => {\n    if (Object.keys(dataSetsBySource).length == 0) return {};\n    return {\n      labels: chartLablesByDateRange[selectedDateRange],\n      datasets: [\n        {\n          label: \"jpdb.io\",\n          data: datasetToPaddedArray(dataSetsBySource.jpdb, selectedDateRange).map(d => d.minutesStudied),\n          borderColor: \"#5dcc06\",\n          backgroundColor: \"#5dcc06\",\n        },\n        {\n          label: \"Bunpro\",\n          data: datasetToPaddedArray(dataSetsBySource.bunpro, selectedDateRange).map(d => d.minutesStudied),\n          borderColor: \"#ff9600\",\n          backgroundColor: \"#ff9600\",\n        },\n        {\n          label: \"Anki\",\n          data: datasetToPaddedArray(dataSetsBySource.anki, selectedDateRange).map(d => d.minutesStudied),\n          borderColor: \"#235390\",\n          backgroundColor: \"#235390\",\n        },\n        {\n          label: \"Immersion\",\n          data: datasetToPaddedArray(dataSetsBySource.immersion, selectedDateRange).map(d => d.minutesStudied),\n          borderColor: \"#cc348d\",\n          backgroundColor: \"#cc348d\",\n        },\n        {\n          label: \"Total\",\n          data: datasetToPaddedArray(\n            [dataSetsBySource.jpdb, dataSetsBySource.bunpro, dataSetsBySource.anki, dataSetsBySource.immersion],\n            selectedDateRange\n          ).map(d => d.minutesStudied),\n          borderColor: \"#e5e5e5\",\n          backgroundColor: \"#e5e5e5\",\n        }\n      ],\n    };\n  }, [dataSetsBySource, selectedDateRange]);\n\n  return(\n    <div style={{maxHeight: \"calc(100vh - 220px)\", padding: \"0 12px 12px 12px\", display: \"flex\", flexDirection: \"column\", alignItems: \"center\"}}>\n      <h1 style={{margin: \"4px 0 18px 0\", padding: \"0\", fontSize: \"28px\", fontWeight: \"600\"}}>\n        Study Trends\n      </h1>\n      <div style={{display: \"flex\", marginBottom: \"12px\"}}>\n        {DATE_RANGES.map((dateRange, index) => {\n          const buttonStyles = { backgroundColor: \"#1baff6\", borderColor: \"#1a99d6\", margin: \"0 2px\", padding: \"5px 10px 3px 10px\" };\n          if (selectedDateRange === dateRange) {\n            buttonStyles.backgroundColor = \"#ce82ff\";\n            buttonStyles.borderColor = \"#a567cc\";\n          }\n          return (\n            <button key={index} className=\"button\" style={buttonStyles} onClick={() => setSearchParams({dateRange: dateRange})}>\n              {dateRange}\n            </button>\n          );\n        })}\n      </div>\n      {\n        !chartData?.datasets ?\n          <p style={{textAlign: \"center\"}}>Loading...</p> :\n          <Line options={chartOptions} data={chartData} />\n      }\n    </div>\n  );\n}\n","/** the getter on react-dom's `useSearchParams` hook doesn't work with the hash\n * router, so use this function instead to read search params from the URL\n*/\nexport const getSearchParams = () => {\n  const cleanLocationString = window.location\n    .toString()\n    .replace(\"/#/\", \"/\")\n    .replace(`${window.location.pathname}#/`, `${window.location.pathname}/`);\n  return new URL(cleanLocationString).searchParams;\n};\n"],"names":["ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Tooltip","Legend","annotationPlugin","getDatesBetween","startDate","endDate","currentDate","Date","getTime","dates","push","setDate","getDate","DATE_RANGES","tenDaysAgo","oneMonthAgo","setMonth","getMonth","threeMonthsAgo","oneYearAgo","setFullYear","getFullYear","tenDaysAgoDateRange","oneMonthDateRange","threeMonthsDateRange","oneYearDateRange","datesForDateRangeString","dateRange","chartLablesByDateRange","forEach","map","d","toLocaleDateString","month","day","weekday","datasetToPaddedArray","dataset","datasetArray","Array","flat","date","dateKey","toISOString","split","matchingDataEntries","filter","undefined","length","minutesStudied","reduce","a","b","standardizedCsvToDataset","csvData","result","parseCsvFile","dateStringKey","previousMinutesStudied","parseFloat","avgFromChartCtx","chartCtx","index","values","chart","data","datasets","at","error","defaultChartOptions","responsive","maintainAspectRatio","plugins","legend","position","annotation","animation","annotations","averageTotal","display","scales","y","title","text","chartOptionsWithAverageAnnotation","type","scaleID","value","ctx","legendItems","hidden","label","content","toFixed","backgroundColor","borderColor","color","backgroundShadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","borderDash","borderWidth","drawTime","borderShadowColor","StudyTrendsPage","useContext","JpdbContext","jpdbData","jpdbIsLoading","BunproContenxt","bunproData","bunproIsLoading","AnkiContext","ankiData","ankiDataIsLoading","ImmersionContext","immersionData","immersionIsLoading","useSearchParams","searchParams","setSearchParams","selectedDateRange","useMemo","urlDateRange","getSearchParams","get","trim","includes","useState","datasetIndexToShowAverageFor","setDatasetIndexToShowAverageFor","chartOptions","useHotkeys","s","dataSetsBySource","jpdb","bunpro","anki","immersion","chartData","Object","keys","labels","style","maxHeight","padding","flexDirection","alignItems","margin","fontSize","fontWeight","marginBottom","buttonStyles","className","onClick","options","textAlign","cleanLocationString","window","location","toString","replace","pathname","URL"],"sourceRoot":""}