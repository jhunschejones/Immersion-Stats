"use strict";(self.webpackChunkimmersion_stats=self.webpackChunkimmersion_stats||[]).push([[643],{1643:(e,t,a)=>{a.r(t),a.d(t,{datasetToPaddedArray:()=>B,default:()=>Q,standardizedCsvToDataset:()=>R});var n=a(9573),o=a(1752),r=a(3623),d=a(2791),s=a(1087),i=a(7221),l=a(4442);const u=(e,t)=>{const a=new Date(e.getTime()),n=[];for(;a<=t;)n.push(new Date(a)),a.setDate(a.getDate()+1);return n},c=new Date((new Date).setDate((new Date).getDate()-10)),p=new Date((new Date).setMonth((new Date).getMonth()-1)),m=new Date((new Date).setMonth((new Date).getMonth()-3)),b=new Date((new Date).setFullYear((new Date).getFullYear()-1)),g=new Date((new Date).setFullYear((new Date).getFullYear()-2)),w=new Date((new Date).setFullYear((new Date).getFullYear()-3)),D=u(c,new Date),h=u(p,new Date),f=u(m,new Date),x=u(b,new Date),v=u(g,new Date),y=u(w,new Date);var C=a(5653),k=a(7387),S=a(1526),Y=a(8995),j=a(6886);const F=()=>{const[e,t]=(0,d.useState)(void 0);return(0,j.y1)("1",(()=>t((e=>0==e?void 0:0))),[]),(0,j.y1)("2",(()=>t((e=>1==e?void 0:1))),[]),(0,j.y1)("3",(()=>t((e=>2==e?void 0:2))),[]),(0,j.y1)("4",(()=>t((e=>3==e?void 0:3))),[]),(0,j.y1)("5",(()=>t((e=>4==e?void 0:4))),[]),(0,j.y1)("backspace",(()=>t(void 0)),[]),{datasetIndex:e}};var I=a(184);n.kL.register(n.uw,n.f$,n.od,n.jn,n.u,n.De,o.Z);const M=["10D","1M","3M","1Y","2Y","3Y"],T=["2Y","3Y"],L=M.filter((e=>!T.includes(e))),O=e=>"1M"==e?h:"3M"==e?f:"1Y"==e?x:"2Y"==e?v:"3Y"==e?y:D,A={};M.forEach((e=>{A[e]=O(e).map((e=>e.toLocaleDateString("en-US",{month:"numeric",day:"numeric",weekday:"short"})))}));const B=(e,t)=>{const a=Array(e).flat();return("string"==typeof t?O(t):t).map((e=>{const t=e.toISOString().split("T")[0],n=a.map((e=>e[t])).filter((e=>void 0!=e));return n.length>0?{date:e,minutesStudied:n.map((e=>e.minutesStudied)).reduce(((e,t)=>e+t),0)}:{date:e,minutesStudied:0}}))},R=e=>{const t={};return(0,l.c)(e).forEach((e=>{const a=new Date(e.Date),n=a.toISOString().split("T")[0];if(t[n]){const o=t[n].minutesStudied;t[n]={date:a,minutesStudied:parseFloat(e["Time (mins)"])+o}}else t[n]={date:a,minutesStudied:parseFloat(e["Time (mins)"])}})),t},z=(e,t)=>{if(e)try{const a=e.chart.data.datasets.at(t).data;return a.reduce(((e,t)=>e+t),0)/a.length}catch(a){return}},E={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},annotation:{animation:!1,annotations:{averageTotal:{display:!1}}}},scales:{y:{title:{display:!0,text:"Study minutes"}}}},P=e=>({...E,plugins:{...E.plugins,annotation:{...E.plugins.annotation,annotations:{...E.plugins.annotation.annotations,averageTotal:{type:"line",scaleID:"y",value:t=>{var a;return null!==(a=z(t,e))&&void 0!==a?a:0},display:t=>!t.chart.legend.legendItems.at(e).hidden,label:{display:!0,content:t=>{var a;return"Avg: ".concat(null===(a=z(t,e))||void 0===a?void 0:a.toFixed(0)," mins/day")},backgroundColor:t=>t.chart.data.datasets.at(e).borderColor,color:t=>"#e5e5e5"==t.chart.data.datasets.at(e).borderColor?"#777":"#FFF",backgroundShadowColor:"#b7b7b7",shadowOffsetX:3,shadowOffsetY:3,shadowBlur:4},borderColor:t=>t.chart.data.datasets.at(e).borderColor,borderDash:[6,6],borderWidth:3,drawTime:"afterDraw",shadowOffsetX:3,shadowOffsetY:3,shadowBlur:4,borderShadowColor:"#b7b7b7"}}}}});function Q(){const{jpdbData:e,jpdbIsLoading:t}=(0,d.useContext)(C.u),{bunproData:a,bunproIsLoading:n}=(0,d.useContext)(k.F),{ankiData:o,ankiDataIsLoading:l}=(0,d.useContext)(S.b),{immersionData:u,immersionIsLoading:c}=(0,d.useContext)(Y.o),[p,m]=(0,s.lr)(),b=(0,d.useMemo)((()=>{var e;const t=null===(e=(0,i.Q)().get("dateRange"))||void 0===e?void 0:e.trim();return t&&M.includes(t)?t:M[0]}),[p]),{datasetIndex:g}=F(),w=(0,d.useMemo)((()=>void 0==g?E:P(g)),[g]),D=(0,d.useMemo)((()=>t||n||l||c||[e,a,o,u].includes(void 0)?{}:{jpdb:R(e),bunpro:R(a),anki:R(o),immersion:R(u)}),[t,e,n,a,l,o,c,u]),h=(0,d.useMemo)((()=>0==Object.keys(D).length?{}:{labels:A[b],datasets:[{label:"jpdb.io",data:B(D.jpdb,b).map((e=>e.minutesStudied)),borderColor:"#5dcc06",backgroundColor:"#5dcc06"},{label:"Bunpro",data:B(D.bunpro,b).map((e=>e.minutesStudied)),borderColor:"#ff9600",backgroundColor:"#ff9600"},{label:"Anki",data:B(D.anki,b).map((e=>e.minutesStudied)),borderColor:"#235390",backgroundColor:"#235390"},{label:"Immersion",data:B(D.immersion,b).map((e=>e.minutesStudied)),borderColor:"#cc348d",backgroundColor:"#cc348d"},{label:"Total",data:B([D.jpdb,D.bunpro,D.anki,D.immersion],b).map((e=>e.minutesStudied)),borderColor:"#e5e5e5",backgroundColor:"#e5e5e5"}]}),[D,b]);return(0,I.jsxs)("div",{style:{maxHeight:"calc(100vh - 220px)",padding:"0 12px 12px 12px",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,I.jsx)("h1",{style:{margin:"4px 0 18px 0",padding:"0",fontSize:"28px",fontWeight:"600"},children:"Study Trends"}),(0,I.jsx)("div",{style:{display:"flex",marginBottom:"12px"},children:L.map(((e,t)=>{const a={backgroundColor:"#1baff6",borderColor:"#1a99d6",margin:"0 2px",padding:"5px 10px 3px 10px"};return b===e&&(a.backgroundColor="#ce82ff",a.borderColor="#a567cc"),(0,I.jsx)("button",{className:"button",style:a,onClick:()=>m({dateRange:e}),children:e},t)}))}),null!==h&&void 0!==h&&h.datasets?(0,I.jsx)(r.x1,{options:w,data:h}):(0,I.jsx)("p",{style:{textAlign:"center"},children:"Loading..."})]})}},7221:(e,t,a)=>{a.d(t,{Q:()=>n});const n=()=>{const e=window.location.toString().replace("/#/","/").replace("".concat(window.location.pathname,"#/"),"".concat(window.location.pathname,"/"));return new URL(e).searchParams}}}]);
//# sourceMappingURL=643.61ec21fe.chunk.js.map